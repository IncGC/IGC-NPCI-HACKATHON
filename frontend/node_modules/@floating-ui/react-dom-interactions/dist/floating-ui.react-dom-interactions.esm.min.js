import{useFloating as e,offset as t,detectOverflow as n,getOverflowAncestors as r}from"@floating-ui/react-dom";export*from"@floating-ui/react-dom";import*as o from"react";import{useLayoutEffect as u,useEffect as c,useRef as l}from"react";import{createPortal as i,flushSync as s}from"react-dom";import{tabbable as a}from"tabbable";import{hideOthers as f}from"aria-hidden";var d="undefined"!=typeof document?u:c;function v(){const e=new Map;return{emit(t,n){var r;null==(r=e.get(t))||r.forEach((e=>e(n)))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){e.set(t,(e.get(t)||[]).filter((e=>e!==n)))}}}let m=!1,p=0;const g=()=>"floating-ui-"+p++;const b=o["useId".toString()],h=null!=b?b:function(){const[e,t]=o.useState((()=>m?g():void 0));return d((()=>{null==e&&t(g())}),[]),o.useEffect((()=>{m||(m=!0)}),[]),e},y=o.createContext(null),w=o.createContext(null),E=()=>{var e,t;return null!=(e=null==(t=o.useContext(y))?void 0:t.id)?e:null},R=()=>o.useContext(w),x=e=>{const t=h(),n=R(),r=E(),o=e||r;return d((()=>{const e={id:t,parentId:o};return null==n||n.addNode(e),()=>{null==n||n.removeNode(e)}}),[n,t,o]),t},k=e=>{let{children:t,id:n}=e;const r=E();return o.createElement(y.Provider,{value:o.useMemo((()=>({id:n,parentId:r})),[n,r])},t)},I=e=>{let{children:t}=e;const n=o.useRef([]),r=o.useCallback((e=>{n.current=[...n.current,e]}),[]),u=o.useCallback((e=>{n.current=n.current.filter((t=>t!==e))}),[]),c=o.useState((()=>v()))[0];return o.createElement(w.Provider,{value:o.useMemo((()=>({nodesRef:n,addNode:r,removeNode:u,events:c})),[n,r,u,c])},t)};function T(e){var t;return null!=(t=null==e?void 0:e.ownerDocument)?t:document}function C(){const e=navigator.userAgentData;return null!=e&&e.platform?e.platform:navigator.platform}function L(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map((e=>{let{brand:t,version:n}=e;return t+"/"+n})).join(" "):navigator.userAgent}function M(e){var t;return null!=(t=T(e).defaultView)?t:window}function A(e){return!!e&&e instanceof M(e).Element}function O(e){return!!e&&e instanceof M(e).HTMLElement}function S(e){if(0===e.mozInputSource&&e.isTrusted)return!0;const t=/Android/i;return(t.test(C())||t.test(L()))&&e.pointerType?"click"===e.type&&1===e.buttons:0===e.detail&&!e.pointerType}function P(e){return 0===e.width&&0===e.height||1===e.width&&1===e.height&&0===e.pressure&&0===e.detail&&"mouse"!==e.pointerType||e.width<1&&e.height<1&&0===e.pressure&&0===e.detail}function D(){return/apple/i.test(navigator.vendor)}function F(){return C().toLowerCase().startsWith("mac")&&!navigator.maxTouchPoints}const H=o["useInsertionEffect".toString()]||(e=>e());function K(e){const t=o.useRef((()=>{}));return H((()=>{t.current=e})),o.useCallback((function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)}),[])}function N(t){let{open:n=!1,onOpenChange:r,whileElementsMounted:u,placement:c,middleware:l,strategy:i,nodeId:s}=void 0===t?{}:t;const[a,f]=o.useState(null),m=R(),p=o.useRef(null),g=o.useRef({}),b=o.useState((()=>v()))[0],h=e({placement:c,middleware:l,strategy:i,whileElementsMounted:u}),y=K(r),w=o.useMemo((()=>({...h.refs,domReference:p})),[h.refs]),E=o.useMemo((()=>({...h,refs:w,dataRef:g,nodeId:s,events:b,open:n,onOpenChange:y,_:{domReference:a}})),[h,s,b,n,y,w,a]);d((()=>{const e=null==m?void 0:m.nodesRef.current.find((e=>e.id===s));e&&(e.context=E)}));const{reference:x}=h,k=o.useCallback((e=>{(A(e)||null===e)&&(E.refs.domReference.current=e,f(e)),x(e)}),[x,E.refs]);return o.useMemo((()=>({...h,context:E,refs:w,reference:k})),[h,w,E,k])}function j(e,t,n){const r=new Map;return{..."floating"===n&&{tabIndex:-1},...e,...t.map((e=>e?e[n]:null)).concat(e).reduce(((e,t)=>t?(Object.entries(t).forEach((t=>{let[n,o]=t;var u;0===n.indexOf("on")?(r.has(n)||r.set(n,[]),"function"==typeof o&&(null==(u=r.get(n))||u.push(o),e[n]=function(){for(var e,t=arguments.length,o=new Array(t),u=0;u<t;u++)o[u]=arguments[u];null==(e=r.get(n))||e.forEach((e=>e(...o)))})):e[n]=o})),e):e),{})}}const B=function(e){void 0===e&&(e=[]);const t=e,n=o.useCallback((t=>j(t,e,"reference")),t),r=o.useCallback((t=>j(t,e,"floating")),t),u=o.useCallback((t=>j(t,e,"item")),t);return o.useMemo((()=>({getReferenceProps:n,getFloatingProps:r,getItemProps:u})),[n,r,u])};function W(e,t){if(!e||!t)return!1;const n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&(r=n,"undefined"!=typeof ShadowRoot&&(r instanceof M(r).ShadowRoot||r instanceof ShadowRoot))){let n=t;do{if(n&&e===n)return!0;n=n.parentNode||n.host}while(n)}var r;return!1}function V(e,t){var n;let r=null!=(n=e.filter((e=>{var n;return e.parentId===t&&(null==(n=e.context)?void 0:n.open)})))?n:[],o=r;for(;o.length;){var u;o=null!=(u=e.filter((e=>{var t;return null==(t=o)?void 0:t.some((t=>{var n;return e.parentId===t.id&&(null==(n=e.context)?void 0:n.open)}))})))?u:[],r=r.concat(o)}return r}function _(e){return"composedPath"in e?e.composedPath()[0]:e.target}function X(e){let t,{restMs:n=0,buffer:r=.5,blockPointerEvents:o=!0,debug:u=null}=void 0===e?{}:e,c=!1;const l=e=>{let{x:o,y:u,placement:l,refs:i,onClose:s,nodeId:a,tree:f,leave:d=!1}=e;return function(e){function v(){clearTimeout(t),s()}clearTimeout(t);const{clientX:m,clientY:p}=e,g=_(e);if("mousemove"===e.type&&W(i.domReference.current,g))return;if("mouseleave"===e.type&&A(e.relatedTarget)&&W(i.floating.current,e.relatedTarget))return;if(f&&V(f.nodesRef.current,a).some((e=>{let{context:t}=e;return null==t?void 0:t.open})))return;if(W(i.floating.current,g)&&!d)return void(c=!0);if(!i.domReference.current||!i.floating.current||null==l||null==o||null==u)return;const b=i.domReference.current.getBoundingClientRect(),h=i.floating.current.getBoundingClientRect(),y=l.split("-")[0],w=o>h.right-h.width/2,E=u>h.bottom-h.height/2;if("top"===y&&u>=b.bottom-1||"bottom"===y&&u<=b.top+1||"left"===y&&o>=b.right-1||"right"===y&&o<=b.left+1)return v();switch(y){case"top":if(m>=h.left&&m<=h.right&&p>=h.top&&p<=b.top+1)return;break;case"bottom":if(m>=h.left&&m<=h.right&&p>=b.bottom-1&&p<=h.bottom)return;break;case"left":if(m>=h.left&&m<=b.left+1&&p>=h.top&&p<=h.bottom)return;break;case"right":if(m>=b.right-1&&m<=h.right&&p>=h.top&&p<=h.bottom)return}if(c)return v();const R=function(e){let[t,n]=e;const o=h.width>b.width,u=h.height>b.height;switch(y){case"top":return[[o?t+r/2:w?t+4*r:t-4*r,n+r+1],[o?t-r/2:w?t+4*r:t-4*r,n+r+1],...[[h.left,w||o?h.bottom-r:h.top],[h.right,w?o?h.bottom-r:h.top:h.bottom-r]]];case"bottom":return[[o?t+r/2:w?t+4*r:t-4*r,n-r],[o?t-r/2:w?t+4*r:t-4*r,n-r],...[[h.left,w||o?h.top+r:h.bottom],[h.right,w?o?h.top+r:h.bottom:h.top+r]]];case"left":{const e=[t+r+1,u?n+r/2:E?n+4*r:n-4*r],o=[t+r+1,u?n-r/2:E?n+4*r:n-4*r];return[...[[E||u?h.right-r:h.left,h.top],[E?u?h.right-r:h.left:h.right-r,h.bottom]],e,o]}case"right":return[[t-r,u?n+r/2:E?n+4*r:n-4*r],[t-r,u?n-r/2:E?n+4*r:n-4*r],...[[E||u?h.left+r:h.right,h.top],[E?u?h.left+r:h.right:h.left+r,h.bottom]]]}}([o,u]);!function(e,t){const[n,r]=e;let o=!1;const u=t.length;for(let e=0,c=u-1;e<u;c=e++){const[u,l]=t[e]||[0,0],[i,s]=t[c]||[0,0];l>=r!=s>=r&&n<=(i-u)*(r-l)/(s-l)+u&&(o=!o)}return o}([m,p],R)?v():n&&(t=setTimeout(s,n))}};return l.__options={blockPointerEvents:o},l}function Y(){return Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Y.apply(this,arguments)}const q={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};let U,z;function G(e){"Tab"===e.key&&(U=e.target,clearTimeout(z))}const J=o.forwardRef((function(e,t){const n=K(e.onFocus),[r,u]=o.useState();return d((()=>(D()&&u("button"),document.addEventListener("keydown",G),()=>{document.removeEventListener("keydown",G)})),[]),o.createElement("span",Y({},e,{ref:t,tabIndex:0,role:r,"aria-hidden":!r||void 0,"data-floating-ui-focus-guard":"",style:q,onFocus:e=>{D()&&F()&&!function(e){const t=U===e.relatedTarget;return U=e.relatedTarget,clearTimeout(z),t}(e)?(e.persist(),z=window.setTimeout((()=>{n(e)}),50)):n(e)}}))}));function Q(e){let t=e.activeElement;for(;null!=(null==(n=t)||null==(r=n.shadowRoot)?void 0:r.activeElement);){var n,r;t=t.shadowRoot.activeElement}return t}const Z=()=>({getShadowRoot:!0,displayCheck:"function"==typeof ResizeObserver&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function $(e,t){const n=a(e,Z());"prev"===t&&n.reverse();const r=n.indexOf(Q(T(e)));return n.slice(r+1)[0]}function ee(){return $(document.body,"next")}function te(){return $(document.body,"prev")}function ne(e,t){const n=t||e.currentTarget,r=e.relatedTarget;return!r||!W(n,r)}function re(e){a(e,Z()).forEach((e=>{var t;e.dataset.tabindex=null!=(t=e.getAttribute("tabindex"))?t:"",e.setAttribute("tabindex","-1")}))}function oe(e){e.querySelectorAll("[data-tabindex]").forEach((e=>{const t=e.dataset.tabindex;delete e.dataset.tabindex,t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")}))}const ue=o.createContext(null),ce=function(e){let{id:t,enabled:n=!0}=void 0===e?{}:e;const[r,u]=o.useState(null),c=h(),l=ie();return d((()=>{if(!n)return;const e=t?document.getElementById(t):null;if(!e){const e=document.createElement("div");e.id=t||c,e.setAttribute("data-floating-ui-portal",""),u(e);const n=(null==l?void 0:l.portalNode)||document.body;return n.appendChild(e),()=>{n.removeChild(e)}}e.setAttribute("data-floating-ui-portal",""),u(e)}),[t,l,c,n]),r},le=e=>{let{children:t,id:n,root:r=null,preserveTabOrder:u=!0}=e;const c=ce({id:n,enabled:!r}),[l,s]=o.useState(null),a=o.useRef(null),f=o.useRef(null),d=o.useRef(null),v=o.useRef(null),m=!!l&&!l.modal&&!(!r&&!c)&&u;return o.useEffect((()=>{if(c&&u&&(null==l||!l.modal))return c.addEventListener("focusin",e,!0),c.addEventListener("focusout",e,!0),()=>{c.removeEventListener("focusin",e,!0),c.removeEventListener("focusout",e,!0)};function e(e){if(c&&ne(e)){("focusin"===e.type?oe:re)(c)}}}),[c,u,null==l?void 0:l.modal]),o.createElement(ue.Provider,{value:o.useMemo((()=>({preserveTabOrder:u,beforeOutsideRef:a,afterOutsideRef:f,beforeInsideRef:d,afterInsideRef:v,portalNode:c,setFocusManagerState:s})),[u,c])},m&&c&&o.createElement(J,{ref:a,onFocus:e=>{if(ne(e,c)){var t;null==(t=d.current)||t.focus()}else{const e=te()||(null==l?void 0:l.refs.domReference.current);null==e||e.focus()}}}),m&&c&&o.createElement("span",{"aria-owns":c.id,style:q}),r?i(t,r):c?i(t,c):null,m&&c&&o.createElement(J,{ref:f,onFocus:e=>{if(ne(e,c)){var t;null==(t=v.current)||t.focus()}else{const e=ee()||(null==l?void 0:l.refs.domReference.current);null==e||e.focus(),null==l||l.onOpenChange(!1)}}}))},ie=()=>o.useContext(ue),se="data-floating-ui-scroll-lock",ae=o.forwardRef((function(e,t){let{lockScroll:n=!1,...r}=e;return d((()=>{var e,t,r,o;if(!n)return;if(document.body.hasAttribute(se))return;document.body.setAttribute(se,"");const u=Math.round(document.documentElement.getBoundingClientRect().left)+document.documentElement.scrollLeft?"paddingLeft":"paddingRight",c=window.innerWidth-document.documentElement.clientWidth;if(!/iP(hone|ad|od)|iOS/.test(C()))return Object.assign(document.body.style,{overflow:"hidden",[u]:c+"px"}),()=>{document.body.removeAttribute(se),Object.assign(document.body.style,{overflow:"",[u]:""})};const l=null!=(e=null==(t=window.visualViewport)?void 0:t.offsetLeft)?e:0,i=null!=(r=null==(o=window.visualViewport)?void 0:o.offsetTop)?r:0,s=window.pageXOffset,a=window.pageYOffset;return Object.assign(document.body.style,{position:"fixed",overflow:"hidden",top:-(a-Math.floor(i))+"px",left:-(s-Math.floor(l))+"px",right:"0",[u]:c+"px"}),()=>{Object.assign(document.body.style,{position:"",overflow:"",top:"",left:"",right:"",[u]:""}),document.body.removeAttribute(se),window.scrollTo(s,a)}}),[n]),o.createElement("div",Y({ref:t},r,{style:{position:"fixed",overflow:"auto",top:0,right:0,bottom:0,left:0,...r.style}}))}));function fe(e){return O(e)&&e.matches("input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])")}function de(e){e.preventDefault(),e.stopPropagation()}function ve(e){const t=l(e);return d((()=>{t.current=e})),t}let me=0;function pe(e,t){void 0===t&&(t={});const{preventScroll:n=!1,cancelPrevious:r=!0,sync:o=!1}=t;r&&cancelAnimationFrame(me);const u=()=>null==e?void 0:e.focus({preventScroll:n});o?u():me=requestAnimationFrame(u)}const ge=o.forwardRef((function(e,t){return o.createElement("button",Y({},e,{ref:t,tabIndex:-1,style:q}))}));function be(e){let{context:t,children:n,order:r=["content"],guards:u=!0,initialFocus:c=0,returnFocus:l=!0,modal:i=!0,visuallyHiddenDismiss:s=!1}=e;const{refs:v,nodeId:m,onOpenChange:p,events:g,_:{domReference:b}}=t,h=ve(r),y=R(),w=ie(),[E,x]=o.useState(null),k="number"==typeof c&&c<0,I=o.useRef(null),C=o.useRef(null),L=o.useRef(!1),M=o.useRef(null),A=null!=w,S=b&&"combobox"===b.getAttribute("role")&&fe(b),P=o.useCallback((function(e){return void 0===e&&(e=v.floating.current),e?a(e,Z()):[]}),[v]),D=o.useCallback((e=>{const t=P(e);return h.current.map((e=>v.domReference.current&&"reference"===e?v.domReference.current:v.floating.current&&"floating"===e?v.floating.current:t)).filter(Boolean).flat()}),[h,v,P]);o.useEffect((()=>{if(!i)return;function e(e){if("Tab"===e.key){0!==P().length||S||de(e);const t=D(),n=_(e);"reference"===h.current[0]&&n===v.domReference.current&&(de(e),e.shiftKey?pe(t[t.length-1]):pe(t[1])),"floating"===h.current[1]&&n===v.floating.current&&e.shiftKey&&(de(e),pe(t[0]))}}const t=T(v.floating.current);return t.addEventListener("keydown",e),()=>{t.removeEventListener("keydown",e)}}),[i,h,v,S,P,D]),o.useEffect((()=>{var e,t;const n=v.floating.current,r=v.domReference.current,o=Array.from(null!=(e=null==w||null==(t=w.portalNode)?void 0:t.querySelectorAll("[data-floating-ui-portal]"))?e:[]);let u=!1;function c(){u=!0,setTimeout((()=>{u=!1}))}function l(e){const t=e.relatedTarget,o=!(W(r,t)||W(n,t)||W(t,n)||W(null==w?void 0:w.portalNode,t)||[null==w?void 0:w.beforeOutsideRef.current,null==w?void 0:w.afterOutsideRef.current].filter(Boolean).includes(t)||y&&(V(y.nodesRef.current,m).find((e=>{var n,r;return W(null==(n=e.context)?void 0:n.refs.floating.current,t)||W(null==(r=e.context)?void 0:r.refs.domReference.current,t)}))||function(e,t){var n;let r=[],o=null==(n=e.find((e=>e.id===t)))?void 0:n.parentId;for(;o;){const t=e.find((e=>e.id===o));o=null==t?void 0:t.parentId,t&&(r=r.concat(t))}return r}(y.nodesRef.current,m).find((e=>{var n,r;return(null==(n=e.context)?void 0:n.refs.floating.current)===t||(null==(r=e.context)?void 0:r.refs.domReference.current)===t}))));t&&o&&!u&&t!==M.current&&(L.current=!0,setTimeout((()=>p(!1))))}if(n&&O(r)){let e;if(i){const t=[n,...o,...[I.current,C.current].filter(Boolean)];e=f(h.current.includes("reference")||S?t.concat(r):t)}return r.addEventListener("focusout",l),r.addEventListener("pointerdown",c),!i&&n.addEventListener("focusout",l),()=>{r.removeEventListener("focusout",l),r.removeEventListener("pointerdown",c),!i&&n.removeEventListener("focusout",l),null==e||e()}}}),[i,c,m,y,h,v,w,S,k,p]),o.useEffect((()=>{const e=v.floating.current;if(i&&!u&&e){const t=[],n=Z(),r=a(T(e).body,n),o=D(),u=r.filter((e=>!o.includes(e)));return u.forEach(((e,n)=>{t[n]=e.getAttribute("tabindex"),e.setAttribute("tabindex","-1")})),()=>{u.forEach(((e,n)=>{const r=t[n];null==r?e.removeAttribute("tabindex"):e.setAttribute("tabindex",r)}))}}}),[i,u,v,D]),d((()=>{const e=v.floating.current;if(!e)return;const t=T(e);let n=l,r=!1;const o=Q(t);M.current=o;const u=D(e),i=("number"==typeof c?u[c]:c.current)||e;function s(e){if("escapeKey"===e.type&&v.domReference.current&&(M.current=v.domReference.current),"outsidePress"!==e.type)return;const t=e.data.returnFocus;"object"==typeof t?(n=!0,r=t.preventScroll):n=t}return!k&&pe(i,{preventScroll:i===e}),g.on("dismiss",s),()=>{g.off("dismiss",s),W(e,Q(t))&&v.domReference.current&&(M.current=v.domReference.current),n&&O(M.current)&&!L.current&&pe(M.current,{preventScroll:r,cancelPrevious:!1})}}),[D,c,l,v,g,k]),d((()=>{if(w)return w.setFocusManagerState({...t,modal:i}),()=>{w.setFocusManagerState(null)}}),[w,i,t]),d((()=>{0!==P().length||k||x(0)}),[P,v,k]);const F=u&&(A||i)&&!S;function H(e){return s&&i?o.createElement(ge,{ref:"start"===e?I:C,onClick:()=>p(!1)},"string"==typeof s?s:"Dismiss"):null}return o.createElement(o.Fragment,null,F&&o.createElement(J,{ref:null==w?void 0:w.beforeInsideRef,onFocus:e=>{if(i){const e=D();pe("reference"===r[0]?e[0]:e[e.length-1])}else if(null!=w&&w.preserveTabOrder&&w.portalNode)if(L.current=!1,ne(e,w.portalNode)){const e=ee()||b;null==e||e.focus()}else{var t;null==(t=w.beforeOutsideRef.current)||t.focus()}}}),S?null:H("start"),o.cloneElement(n,0===E||r.includes("floating")?{tabIndex:0}:{}),H("end"),F&&o.createElement(J,{ref:null==w?void 0:w.afterInsideRef,onFocus:e=>{if(i)pe(D()[0]);else if(null!=w&&w.preserveTabOrder&&w.portalNode)if(L.current=!0,ne(e,w.portalNode)){const e=te()||b;null==e||e.focus()}else{var t;null==(t=w.afterOutsideRef.current)||t.focus()}}}))}const he=["mouse","pen","",void 0];function ye(e,t,n){return n&&!he.includes(n)?0:"number"==typeof e?e:null==e?void 0:e[t]}const we=function(e,t){let{enabled:n=!0,delay:r=0,handleClose:u=null,mouseOnly:c=!1,restMs:l=0,move:i=!0}=void 0===t?{}:t;const{open:s,onOpenChange:a,dataRef:f,events:v,refs:m,_:p}=e,g=R(),b=E(),h=ve(u),y=ve(r),w=o.useRef(),x=o.useRef(),k=o.useRef(),I=o.useRef(),C=o.useRef(!0),L=o.useRef(!1),M=o.useCallback((()=>{var e;const t=null==(e=f.current.openEvent)?void 0:e.type;return(null==t?void 0:t.includes("mouse"))&&"mousedown"!==t}),[f]);o.useEffect((()=>{if(n)return v.on("dismiss",e),()=>{v.off("dismiss",e)};function e(){clearTimeout(x.current),clearTimeout(I.current),C.current=!0}}),[n,v,m]),o.useEffect((()=>{if(!n||!h.current||!s)return;function e(){M()&&a(!1)}const t=T(m.floating.current).documentElement;return t.addEventListener("mouseleave",e),()=>{t.removeEventListener("mouseleave",e)}}),[m,s,a,n,h,f,M]);const O=o.useCallback((function(e){void 0===e&&(e=!0);const t=ye(y.current,"close",w.current);t&&!k.current?(clearTimeout(x.current),x.current=setTimeout((()=>a(!1)),t)):e&&(clearTimeout(x.current),a(!1))}),[y,a]),S=o.useCallback((()=>{k.current&&(T(m.floating.current).removeEventListener("mousemove",k.current),k.current=void 0)}),[m]),P=o.useCallback((()=>{T(m.floating.current).body.style.pointerEvents="",L.current=!1}),[m]);return o.useEffect((()=>{if(!n)return;function t(){return!!f.current.openEvent&&["click","mousedown"].includes(f.current.openEvent.type)}function r(e){if(clearTimeout(x.current),C.current=!1,c&&!he.includes(w.current)||l>0&&0===ye(y.current,"open"))return;f.current.openEvent=e;const t=ye(y.current,"open",w.current);t?x.current=setTimeout((()=>{a(!0)}),t):a(!0)}function o(n){if(t())return;const r=T(m.floating.current);if(clearTimeout(I.current),h.current)return clearTimeout(x.current),k.current&&r.removeEventListener("mousemove",k.current),k.current=h.current({...e,tree:g,x:n.clientX,y:n.clientY,onClose(){P(),S(),O()}}),void r.addEventListener("mousemove",k.current);O()}function u(n){t()||null==h.current||h.current({...e,tree:g,x:n.clientX,y:n.clientY,leave:!0,onClose(){P(),S(),O()}})(n)}const d=m.floating.current,v=m.domReference.current;return A(v)?(s&&v.addEventListener("mouseleave",u),null==d||d.addEventListener("mouseleave",u),i&&v.addEventListener("mousemove",r,{once:!0}),v.addEventListener("mouseenter",r),v.addEventListener("mouseleave",o),()=>{s&&v.removeEventListener("mouseleave",u),null==d||d.removeEventListener("mouseleave",u),i&&v.removeEventListener("mousemove",r),v.removeEventListener("mouseenter",r),v.removeEventListener("mouseleave",o)}):void 0}),[p.domReference,n,e,c,l,i,O,S,P,a,s,g,m,y,h,f]),d((()=>{if(n&&s&&h.current&&h.current.__options.blockPointerEvents&&M()){T(m.floating.current).body.style.pointerEvents="none",L.current=!0;const n=m.domReference.current,r=m.floating.current;if(A(n)&&r){var e,t;const o=null==g||null==(e=g.nodesRef.current.find((e=>e.id===b)))||null==(t=e.context)?void 0:t.refs.floating.current;return o&&(o.style.pointerEvents=""),n.style.pointerEvents="auto",r.style.pointerEvents="auto",()=>{n.style.pointerEvents="",r.style.pointerEvents=""}}}}),[n,s,b,m,g,h,f,M]),d((()=>{s||(w.current=void 0,S(),L.current&&P())}),[s,S,P]),o.useEffect((()=>()=>{S(),clearTimeout(x.current),clearTimeout(I.current),L.current&&P()}),[n,S,P]),o.useMemo((()=>{if(!n)return{};function e(e){w.current=e.pointerType}return{reference:{onPointerDown:e,onPointerEnter:e,onMouseMove(){s||0===l||(clearTimeout(I.current),I.current=setTimeout((()=>{C.current||a(!0)}),l))}},floating:{onMouseEnter(){clearTimeout(x.current)},onMouseLeave(){O(!1)}}}}),[n,l,s,a,O])},Ee=o.createContext({delay:1e3,initialDelay:1e3,currentId:null,setCurrentId:()=>{},setState:()=>{}}),Re=()=>o.useContext(Ee),xe=e=>{let{children:t,delay:n}=e;const[r,u]=o.useState({delay:n,initialDelay:n,currentId:null}),c=o.useCallback((e=>{u((t=>({...t,currentId:e})))}),[]);return o.createElement(Ee.Provider,{value:o.useMemo((()=>({...r,setState:u,setCurrentId:c})),[r,u,c])},t)},ke=(e,t)=>{let{open:n,onOpenChange:r}=e,{id:u}=t;const{currentId:c,initialDelay:l,setState:i}=Re();o.useEffect((()=>{c&&(i((e=>({...e,delay:{open:1,close:ye(l,"close")}}))),c!==u&&r(!1))}),[u,r,i,c,l]),o.useEffect((()=>{n||c!==u||(r(!1),i((e=>({...e,delay:l,currentId:null}))))}),[n,i,c,u,r,l])};function Ie(e,t){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:t}}}}const Te=e=>({name:"inner",options:e,async fn(r){var o;const{listRef:u,overflowRef:c,onFallbackChange:l,offset:i=0,index:a=0,minItemsVisible:f=4,referenceOverflowThreshold:d=0,scrollRef:v,...m}=e,{rects:p,elements:{floating:g}}=r,b=u.current[a];if(!b)return{};const h={...r,...await t(-b.offsetTop-p.reference.height/2-b.offsetHeight/2-i).fn(r)},y=null!=(o=null==v?void 0:v.current)?o:g,w=await n(Ie(h,y.scrollHeight),m),E=await n(h,{...m,elementContext:"reference"}),R=Math.max(0,w.top),x=h.y+R,k=Math.max(0,y.scrollHeight-R-Math.max(0,w.bottom));return y.style.maxHeight=k+"px",y.scrollTop=R,l&&(y.offsetHeight<b.offsetHeight*Math.min(f,u.current.length-1)-1||E.top>=-d||E.bottom>=-d?s((()=>l(!0))):s((()=>l(!1)))),c&&(c.current=await n(Ie({...h,y:x},y.offsetHeight),m)),{y:x}}}),Ce=(e,t)=>{let{open:n,refs:r}=e,{enabled:u=!0,overflowRef:c,scrollRef:l,onChange:i}=t;const a=K(i),f=o.useRef(!1),d=o.useRef(null),v=o.useRef(null);return o.useEffect((()=>{var e;if(!u)return;function t(e){if(e.ctrlKey||!o||null==c.current)return;const t=e.deltaY,n=c.current.top>=-.5,r=c.current.bottom>=-.5,u=o.scrollHeight-o.clientHeight,l=t<0?-1:1,i=t<0?"max":"min";o.scrollHeight<=o.clientHeight||(!n&&t>0||!r&&t<0?(e.preventDefault(),s((()=>{a((e=>e+Math[i](t,u*l)))}))):/firefox/i.test(L())&&(o.scrollTop+=t))}const o=null!=(e=null==l?void 0:l.current)?e:r.floating.current;return n&&o?(o.addEventListener("wheel",t),requestAnimationFrame((()=>{d.current=o.scrollTop,null!=c.current&&(v.current={...c.current})})),()=>{d.current=null,v.current=null,o.removeEventListener("wheel",t)}):void 0}),[u,n,r,c,l,a]),o.useMemo((()=>u?{floating:{onKeyDown(){f.current=!0},onWheel(){f.current=!1},onPointerMove(){f.current=!1},onScroll(){const e=(null==l?void 0:l.current)||r.floating.current;if(c.current&&e&&f.current){if(null!==d.current){const t=e.scrollTop-d.current;(c.current.bottom<-.5&&t<-1||c.current.top<-.5&&t>1)&&s((()=>a((e=>e+t))))}requestAnimationFrame((()=>{d.current=e.scrollTop}))}}}}:{}),[u,c,r,l,a])},Le=function(e,t){let{open:n}=e,{enabled:r=!0,role:u="dialog"}=void 0===t?{}:t;const c=h(),l=h();return o.useMemo((()=>{const e={id:c,role:u};return r?"tooltip"===u?{reference:{"aria-describedby":n?c:void 0},floating:e}:{reference:{"aria-expanded":n?"true":"false","aria-haspopup":"alertdialog"===u?"dialog":u,"aria-controls":n?c:void 0,..."listbox"===u&&{role:"combobox"},..."menu"===u&&{id:l}},floating:{...e,..."menu"===u&&{"aria-labelledby":l}}}:{}}),[r,u,n,c,l])};function Me(e){return O(e.target)&&"BUTTON"===e.target.tagName}function Ae(e){return fe(e)}const Oe=function(e,t){let{open:n,onOpenChange:r,dataRef:u,refs:c}=e,{enabled:l=!0,event:i="click",toggle:s=!0,ignoreMouse:a=!1,keyboardHandlers:f=!0}=void 0===t?{}:t;const d=o.useRef();return o.useMemo((()=>l?{reference:{onPointerDown(e){d.current=e.pointerType},onMouseDown(e){0===e.button&&("mouse"===d.current&&a||"click"!==i&&(n?!s||u.current.openEvent&&"mousedown"!==u.current.openEvent.type||r(!1):(e.preventDefault(),r(!0)),u.current.openEvent=e.nativeEvent))},onClick(e){"mousedown"===i&&d.current?d.current=void 0:"mouse"===d.current&&a||(n?!s||u.current.openEvent&&"click"!==u.current.openEvent.type||r(!1):r(!0),u.current.openEvent=e.nativeEvent)},onKeyDown(e){d.current=void 0,f&&(Me(e)||(" "!==e.key||Ae(c.domReference.current)||e.preventDefault(),"Enter"===e.key&&(n?s&&r(!1):r(!0))))},onKeyUp(e){f&&(Me(e)||Ae(c.domReference.current)||" "===e.key&&(n?s&&r(!1):r(!0)))}}}:{}),[l,u,i,a,f,c,s,n,r])};function Se(e,t){if(null==t)return!1;if("composedPath"in e)return e.composedPath().includes(t);const n=e;return null!=n.target&&t.contains(n.target)}const Pe={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},De={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},Fe=function(e,t){let{open:n,onOpenChange:u,refs:c,events:l,nodeId:i}=e,{enabled:s=!0,escapeKey:a=!0,outsidePress:f=!0,outsidePressEvent:d="pointerdown",referencePress:v=!1,referencePressEvent:m="pointerdown",ancestorScroll:p=!1,bubbles:g=!0}=void 0===t?{}:t;const b=R(),h=null!=E(),y=ve(f),w=o.useRef(!1);return o.useEffect((()=>{if(!n||!s)return;const e=y.current;function t(e){if("Escape"===e.key){if(!g&&b&&V(b.nodesRef.current,i).length>0)return;l.emit("dismiss",{type:"escapeKey",data:{returnFocus:{preventScroll:!1}}}),u(!1)}}function o(t){const n=w.current;if(w.current=!1,n)return;if("function"==typeof e&&!e(t))return;const r=_(t);if(A(r)&&c.floating.current){var o;const e=null!=(o=c.floating.current.ownerDocument.defaultView)?o:window,n=r.scrollWidth>r.clientWidth,u=r.scrollHeight>r.clientHeight;let l=u&&t.offsetX>r.clientWidth;if(u){"rtl"===e.getComputedStyle(r).direction&&(l=t.offsetX<=r.offsetWidth-r.clientWidth)}if(l||n&&t.offsetY>r.clientHeight)return}const s=b&&V(b.nodesRef.current,i).some((e=>{var n;return Se(t,null==(n=e.context)?void 0:n.refs.floating.current)}));Se(t,c.floating.current)||Se(t,c.domReference.current)||s||!g&&b&&V(b.nodesRef.current,i).length>0||(l.emit("dismiss",{type:"outsidePress",data:{returnFocus:h?{preventScroll:!0}:S(t)||P(t)}}),u(!1))}function f(){u(!1)}const v=T(c.floating.current);a&&v.addEventListener("keydown",t),e&&v.addEventListener(d,o);let m=[];return p&&(A(c.domReference.current)&&(m=r(c.domReference.current)),A(c.floating.current)&&(m=m.concat(r(c.floating.current))),!A(c.reference.current)&&c.reference.current&&c.reference.current.contextElement&&(m=m.concat(r(c.reference.current.contextElement)))),m=m.filter((e=>{var t;return e!==(null==(t=v.defaultView)?void 0:t.visualViewport)})),m.forEach((e=>{e.addEventListener("scroll",f,{passive:!0})})),()=>{a&&v.removeEventListener("keydown",t),e&&v.removeEventListener(d,o),m.forEach((e=>{e.removeEventListener("scroll",f)}))}}),[a,y,d,l,b,i,n,u,p,s,g,c,h]),o.useEffect((()=>{w.current=!1}),[f,d]),o.useMemo((()=>s?{reference:{[Pe[m]]:()=>{v&&(l.emit("dismiss",{type:"referencePress",data:{returnFocus:!1}}),u(!1))}},floating:{[De[d]]:()=>{w.current=!0}}}:{}),[s,l,v,d,m,u])},He=function(e,t){let{open:n,onOpenChange:r,dataRef:u,refs:c,events:l}=e,{enabled:i=!0,keyboardOnly:s=!0}=void 0===t?{}:t;const a=o.useRef(""),f=o.useRef(!1),d=o.useRef();return o.useEffect((()=>{var e;if(!i)return;const t=null!=(e=T(c.floating.current).defaultView)?e:window;function r(){!n&&O(c.domReference.current)&&c.domReference.current===Q(T(c.domReference.current))&&(f.current=!0)}return t.addEventListener("blur",r),()=>{t.removeEventListener("blur",r)}}),[c,n,i]),o.useEffect((()=>{if(i)return l.on("dismiss",e),()=>{l.off("dismiss",e)};function e(e){"referencePress"!==e.type&&"escapeKey"!==e.type||(f.current=!0)}}),[l,i]),o.useEffect((()=>()=>{clearTimeout(d.current)}),[]),o.useMemo((()=>i?{reference:{onPointerDown(e){let{pointerType:t}=e;a.current=t,f.current=!(!t||!s)},onMouseLeave(){f.current=!1},onFocus(e){var t;f.current||"focus"===e.type&&"mousedown"===(null==(t=u.current.openEvent)?void 0:t.type)&&u.current.openEvent&&Se(u.current.openEvent,c.domReference.current)||(u.current.openEvent=e.nativeEvent,r(!0))},onBlur(e){f.current=!1;const t=e.relatedTarget,n=A(t)&&t.hasAttribute("data-floating-ui-focus-guard");d.current=setTimeout((()=>{W(c.floating.current,t)||W(c.domReference.current,t)||n||r(!1)}))}}}:{}),[i,s,c,u,r])};let Ke=!1;function Ne(e,t,n){return Math.floor(e/t)!==n}function je(e,t){return t<0||t>=e.current.length}function Be(e,t){let{startingIndex:n=-1,decrement:r=!1,disabledIndices:o,amount:u=1}=void 0===t?{}:t;const c=e.current;let l=n;do{var i,s;l+=r?-u:u}while(l>=0&&l<=c.length-1&&(o?o.includes(l):null==c[l]||(null==(i=c[l])?void 0:i.hasAttribute("disabled"))||"true"===(null==(s=c[l])?void 0:s.getAttribute("aria-disabled"))));return l}function We(e,t,n){switch(e){case"vertical":return t;case"horizontal":return n;default:return t||n}}function Ve(e,t){return We(t,"ArrowUp"===e||"ArrowDown"===e,"ArrowLeft"===e||"ArrowRight"===e)}function _e(e,t,n){return We(t,"ArrowDown"===e,n?"ArrowLeft"===e:"ArrowRight"===e)||"Enter"===e||" "==e||""===e}function Xe(e,t){return Be(e,{disabledIndices:t})}function Ye(e,t){return Be(e,{decrement:!0,startingIndex:e.current.length,disabledIndices:t})}const qe=function(e,t){let{open:n,onOpenChange:r,refs:u}=e,{listRef:c,activeIndex:l,onNavigate:i=(()=>{}),enabled:a=!0,selectedIndex:f=null,allowEscape:v=!1,loop:m=!1,nested:p=!1,rtl:g=!1,virtual:b=!1,focusItemOnOpen:h="auto",focusItemOnHover:y=!0,openOnArrowKeyDown:w=!0,disabledIndices:x,orientation:k="vertical",cols:I=1}=void 0===t?{listRef:{current:[]},activeIndex:null,onNavigate:()=>{}}:t;const C=E(),L=R(),M=K(i),A=o.useRef(h),H=o.useRef(null!=f?f:-1),N=o.useRef(null),j=o.useRef(!1),B=o.useRef(M),V=o.useRef(n),_=o.useRef(!1),X=ve(x),Y=ve(n),[q,U]=o.useState(),z=o.useCallback(((e,t)=>{if(b){var n;U(null==(n=e.current[t.current])?void 0:n.id)}else{pe(e.current[t.current],{preventScroll:!0,sync:!(!F()||!D())&&(Ke||_.current)})}}),[b]);return d((()=>{document.createElement("div").focus({get preventScroll(){return Ke=!0,!1}})}),[]),d((()=>{a&&(n?A.current&&null!=f&&M(f):V.current&&(H.current=-1,B.current(null)))}),[a,n,f,M]),d((()=>{if(a&&n)if(null==l){if(_.current=!1,null!=f)return;V.current&&(H.current=-1,z(c,H)),!V.current&&A.current&&(null!=N.current||!0===A.current&&null==N.current)&&(H.current=null==N.current||_e(N.current,k,g)||p?Xe(c,X.current):Ye(c,X.current),M(H.current))}else je(c,l)||(H.current=l,z(c,H))}),[a,n,l,f,p,c,k,g,M,z,X]),d((()=>{if(a&&V.current&&!n){var e,t;const n=null==L||null==(e=L.nodesRef.current.find((e=>e.id===C)))||null==(t=e.context)?void 0:t.refs.floating.current;n&&!W(n,Q(T(n)))&&n.focus({preventScroll:!0})}}),[a,n,L,C]),d((()=>{N.current=null,B.current=M,V.current=n})),o.useMemo((()=>{if(!a)return{};const e=X.current;function t(t){if(j.current=!0,_.current=!0,!Y.current&&t.currentTarget===u.floating.current)return;if(p&&function(e,t,n){return We(t,n?"ArrowRight"===e:"ArrowLeft"===e,"ArrowUp"===e)}(t.key,k,g))return de(t),r(!1),void(O(u.domReference.current)&&u.domReference.current.focus());const o=H.current,l=Xe(c,e),i=Ye(c,e);if("Home"===t.key&&(H.current=l,M(H.current)),"End"===t.key&&(H.current=i,M(H.current)),I>1){const n=H.current;if("ArrowUp"===t.key){if(de(t),-1===n)H.current=i;else if(H.current=Be(c,{startingIndex:n,amount:I,decrement:!0,disabledIndices:e}),m&&(n-I<l||H.current<0)){const e=n%I,t=i%I,r=i-(t-e);H.current=t===e?i:t>e?r:r-I}je(c,H.current)&&(H.current=n),M(H.current)}if("ArrowDown"===t.key&&(de(t),-1===n?H.current=l:(H.current=Be(c,{startingIndex:n,amount:I,disabledIndices:e}),m&&n+I>i&&(H.current=Be(c,{startingIndex:n%I-I,amount:I,disabledIndices:e}))),je(c,H.current)&&(H.current=n),M(H.current)),"both"===k){const r=Math.floor(n/I);"ArrowRight"===t.key&&(de(t),n%I!=I-1?(H.current=Be(c,{startingIndex:n,disabledIndices:e}),m&&Ne(H.current,I,r)&&(H.current=Be(c,{startingIndex:n-n%I-1,disabledIndices:e}))):m&&(H.current=Be(c,{startingIndex:n-n%I-1,disabledIndices:e})),Ne(H.current,I,r)&&(H.current=n)),"ArrowLeft"===t.key&&(de(t),n%I!=0?(H.current=Be(c,{startingIndex:n,disabledIndices:e,decrement:!0}),m&&Ne(H.current,I,r)&&(H.current=Be(c,{startingIndex:n+(I-n%I),decrement:!0,disabledIndices:e}))):m&&(H.current=Be(c,{startingIndex:n+(I-n%I),decrement:!0,disabledIndices:e})),Ne(H.current,I,r)&&(H.current=n));const o=Math.floor(i/I)===r;return je(c,H.current)&&(H.current=m&&o?"ArrowLeft"===t.key?i:Be(c,{startingIndex:n-n%I-1,disabledIndices:e}):n),void M(H.current)}}if(Ve(t.key,k)){if(de(t),n&&!b&&Q(t.currentTarget.ownerDocument)===t.currentTarget)return H.current=_e(t.key,k,g)?l:i,void M(H.current);_e(t.key,k,g)?H.current=m?o>=i?v&&o!==c.current.length?-1:l:Be(c,{startingIndex:o,disabledIndices:e}):Math.min(i,Be(c,{startingIndex:o,disabledIndices:e})):H.current=m?o<=l?v&&-1!==o?c.current.length:i:Be(c,{startingIndex:o,decrement:!0,disabledIndices:e}):Math.max(l,Be(c,{startingIndex:o,decrement:!0,disabledIndices:e})),je(c,H.current)?M(null):M(H.current)}}function o(e){"auto"===h&&S(e.nativeEvent)&&(A.current=!0)}return{reference:{...b&&n&&null!=l&&{"aria-activedescendant":q},onKeyDown(o){j.current=!0;const u=0===o.key.indexOf("Arrow");if(b&&n)return t(o);if(!n&&!w&&u)return;(u||"Enter"===o.key||" "===o.key||""===o.key)&&(N.current=o.key),p?function(e,t,n){return We(t,n?"ArrowLeft"===e:"ArrowRight"===e,"ArrowDown"===e)}(o.key,k,g)&&(de(o),n?(H.current=Xe(c,e),M(H.current)):r(!0)):Ve(o.key,k)&&(null!=f&&(H.current=f),de(o),!n&&w?r(!0):t(o),n&&M(H.current))},onFocus(){n&&M(null)},onPointerDown:function(e){A.current=h,"auto"===h&&P(e.nativeEvent)&&(A.current=!0)},onMouseDown:o,onClick:o},floating:{"aria-orientation":"both"===k?void 0:k,...b&&null!=l&&{"aria-activedescendant":q},onKeyDown:t,onPointerMove(){j.current=!1}},item:{onFocus(e){let{currentTarget:t}=e;const n=c.current.indexOf(t);-1!==n&&l!==n&&M(n)},onClick:e=>{let{currentTarget:t}=e;return t.focus({preventScroll:!0})},...y&&{onMouseMove(e){let{currentTarget:t}=e;const n=t;if(n){const e=c.current.indexOf(n);-1!==e&&l!==e&&M(e)}},onPointerLeave(){var e;j.current||(H.current=-1,z(c,H),s((()=>M(null))),b||null==(e=u.floating.current)||e.focus({preventScroll:!0}))}}}}}),[q,X,Y,c,a,k,g,b,n,l,p,f,w,y,v,I,m,u,h,z,M,r])},Ue=function(e,t){var n;let{open:r,dataRef:u}=e,{listRef:c,activeIndex:l,onMatch:i=(()=>{}),enabled:s=!0,findMatch:a=null,resetMs:f=1e3,ignoreKeys:v=[],selectedIndex:m=null}=void 0===t?{listRef:{current:[]},activeIndex:null}:t;const p=o.useRef(),g=o.useRef(""),b=o.useRef(null!=(n=null!=m?m:l)?n:-1),h=o.useRef(null),y=K(i),w=ve(a),E=ve(v);return d((()=>{r&&(clearTimeout(p.current),h.current=null,g.current="")}),[r]),d((()=>{var e;r&&""===g.current&&(b.current=null!=(e=null!=m?m:l)?e:-1)}),[r,m,l]),o.useMemo((()=>{if(!s)return{};function e(e){const t=_(e.nativeEvent);if(A(t)&&Q(T(t))!==e.currentTarget&&t.closest('[role="dialog"],[role="menu"],[role="listbox"],[role="tree"],[role="grid"]')!==e.currentTarget)return;g.current.length>0&&" "!==g.current[0]&&(u.current.typing=!0," "===e.key&&de(e));const n=c.current;if(null==n||E.current.includes(e.key)||1!==e.key.length||e.ctrlKey||e.metaKey||e.altKey)return;n.every((e=>{var t,n;return!e||(null==(t=e[0])?void 0:t.toLocaleLowerCase())!==(null==(n=e[1])?void 0:n.toLocaleLowerCase())}))&&g.current===e.key&&(g.current="",b.current=h.current),g.current+=e.key,clearTimeout(p.current),p.current=setTimeout((()=>{g.current="",b.current=h.current,u.current.typing=!1}),f);const r=b.current,o=[...n.slice((null!=r?r:0)+1),...n.slice(0,(null!=r?r:0)+1)],l=w.current?w.current(o,g.current):o.find((e=>0===(null==e?void 0:e.toLocaleLowerCase().indexOf(g.current.toLocaleLowerCase())))),i=l?n.indexOf(l):-1;-1!==i&&(y(i),h.current=i)}return{reference:{onKeyDown:e},floating:{onKeyDown:e}}}),[s,u,c,f,E,w,y])};export{xe as FloatingDelayGroup,be as FloatingFocusManager,k as FloatingNode,ae as FloatingOverlay,le as FloatingPortal,I as FloatingTree,Te as inner,X as safePolygon,Oe as useClick,ke as useDelayGroup,Re as useDelayGroupContext,Fe as useDismiss,N as useFloating,x as useFloatingNodeId,E as useFloatingParentNodeId,ce as useFloatingPortalNode,R as useFloatingTree,He as useFocus,we as useHover,h as useId,Ce as useInnerOffset,B as useInteractions,qe as useListNavigation,Le as useRole,Ue as useTypeahead};
